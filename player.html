<script>
    // Obtener parámetros de la URL
    const params = new URLSearchParams(window.location.search);
    const videoUrl = params.get('video') || 'https://www.example.com/default-video.mp4';
    const posterUrl = params.get('poster') || '';

    // Leer subtítulos
    const subtitles = [];
    let index = 1;
    while (params.has(`subtitle${index}`) && params.has(`subtitle${index}-lang`)) {
        subtitles.push({
            src: params.get(`subtitle${index}`),
            kind: 'subtitles',
            srclang: params.get(`subtitle${index}-lang`),
            label: params.get(`subtitle${index}-lang`).toUpperCase(),
            default: index === 1 // El primer subtítulo será el predeterminado
        });
        index++;
    }

    // Configurar el reproductor
    fluidPlayer(
        'video-player', {
            layoutControls: {
                primaryColor: "#FF6600",
                posterImage: posterUrl || null,
                fillToContainer: true,
                autoPlay: false,
                allowTheatre: true,
                allowFullScreen: true,
                controlBar: {
                    autoHide: true,
                    autoHideTimeout: 3
                }
            },
            tracks: subtitles // Agregar subtítulos al reproductor
        }
    );

    // Establecer la fuente del video
    const videoElement = document.getElementById('video-player');
    videoElement.src = videoUrl;

    // Manejar errores de carga
    videoElement.onerror = () => {
        const container = document.getElementById('video-container');
        container.innerHTML = `
            <div style="color: white; text-align: center; font-size: 1.5em;">
                Error al cargar el video. Por favor, verifica la URL.
            </div>
        `;
    };
</script>
