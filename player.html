<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Reproductor con Anuncio Personalizado</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #000;
        }

        #video-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #video-player, #ad-video {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            object-fit: contain;
            aspect-ratio: 16 / 9;
        }

        #skip-button {
            position: absolute;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            z-index: 10;
        }

        #skip-button:hover {
            background-color: rgba(255, 0, 0, 0.7);
        }
    </style>
</head>
<body>
    <div id="video-container">
        <!-- Video principal -->
        <video id="video-player" controls style="display: none;">
            Tu navegador no soporta el elemento de video.
        </video>

        <!-- Video de anuncio -->
        <video id="ad-video" controls autoplay muted>
            Tu navegador no soporta el elemento de video.
        </video>

        <!-- Botón de saltar -->
        <button id="skip-button" style="display: none;">Saltar en <span id="skip-timer">10</span>s</button>
    </div>

    <script>
        // Obtener parámetros de la URL
        const params = new URLSearchParams(window.location.search);
        const mainVideoUrl = params.get('video') || ''; // URL del video principal
        const posterUrl = params.get('poster') || ''; // URL de la imagen de portada

        // URLs del anuncio
        const adVideoUrl = 'https://www.youtube.com/embed/7flT6J_1P7Y?si=dmsqWqYEHbbnXttC'; // Reemplaza con tu video de anuncio
        const redirectUrl = 'https://www.example.com'; // URL de redirección al hacer clic en "Saltar"

        // Elementos del DOM
        const videoPlayer = document.getElementById('video-player');
        const adVideo = document.getElementById('ad-video');
        const skipButton = document.getElementById('skip-button');
        const skipTimer = document.getElementById('skip-timer');

        let skipTimerCount = 10; // Tiempo inicial del contador
        let hasRedirected = false; // Bandera para verificar si ya se redirigió

        // Validar que el video principal esté presente
        if (!mainVideoUrl) {
            document.getElementById('video-container').innerHTML = `
                <div style="color: white; text-align: center; font-size: 1.5em;">
                    Error: No se proporcionó una URL válida para el video principal.
                </div>
            `;
        } else {
            // Configurar el video principal
            videoPlayer.src = mainVideoUrl;
            if (posterUrl) {
                videoPlayer.poster = posterUrl; // Establecer imagen de portada
            }

            // Configurar el video de anuncio
            adVideo.src = adVideoUrl;
            adVideo.addEventListener('ended', () => {
                showMainVideo(); // Si el anuncio termina, muestra el video principal
            });

            // Mostrar el botón de saltar después de cargar el anuncio
            adVideo.addEventListener('canplay', () => {
                skipButton.style.display = 'block';
                startSkipTimer();
            });

            // Iniciar el contador del botón de saltar
            function startSkipTimer() {
                const timerInterval = setInterval(() => {
                    skipTimerCount--;
                    skipTimer.textContent = skipTimerCount;

                    if (skipTimerCount <= 0) {
                        clearInterval(timerInterval);
                        skipButton.textContent = 'Saltar ahora';
                        skipButton.disabled = false;
                    }
                }, 1000);
            }

            // Acción al hacer clic en el botón de saltar
            skipButton.addEventListener('click', () => {
                if (!hasRedirected) {
                    // Redirigir a la página externa
                    window.open(redirectUrl, '_blank');
                    hasRedirected = true; // Marcar como redirigido
                    skipButton.textContent = 'Saltar ahora';
                } else {
                    // Saltar el anuncio y mostrar el video principal
                    showMainVideo();
                }
            });

            // Mostrar el video principal y ocultar el anuncio
            function showMainVideo() {
                adVideo.pause();
                adVideo.style.display = 'none';
                videoPlayer.style.display = 'block';
                videoPlayer.play();
            }
        }
    </script>
</body>
</html>
