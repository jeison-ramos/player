<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Reproductor con Anuncios VAST</title>
    <script src="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #000;
        }
        #video-container {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #video-player {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            aspect-ratio: 16/9;
        }
    </style>
</head>
<body>
    <div id="video-container">
        <video id="video-player" controls>
            <source src="" type="video/mp4">
        </video>
    </div>

    <script>
        // Configuraci칩n principal
        const params = new URLSearchParams(window.location.search);
        const videoUrl = params.get('video') || 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4';
        const posterUrl = params.get('poster') || '';

        // TU VAST URL INTEGRADA
        const YOUR_VAST_URL = 'https://fake-square.com/d.m/FazvdhG/NTv/ZUGEUH/qeXmZ9WuWZ/UolHkDPkTuY/wzNWj_I/yFMfDmcRtgN/jfA_2SMDj_ILwUOdCbZIsZaTWf1HpPdsDm0lxe';

        // Configuraci칩n de anuncios
        const adList = [{
            roll: 'pre-roll',
            vastTag: YOUR_VAST_URL,
            adText: 'Patrocinado por tu Marca' // Personaliza este texto
        }];

        // A침adir midroll desde par치metros (opcional)
        const midrollParam = params.get('midroll');
        if(midrollParam) {
            const [vastTag, timer] = midrollParam.split(',');
            adList.push({
                roll: 'mid-roll',
                vastTag: vastTag,
                timer: parseInt(timer, 10)
            });
        }

        // Inicializar reproductor
        fluidPlayer('video-player', {
            layoutControls: {
                primaryColor: "#FF6600",
                posterImage: posterUrl,
                fillToContainer: true,
                autoPlay: false,
                allowTheatre: true,
                controlBar: {
                    autoHide: true,
                    autoHideTimeout: 3
                }
            },
            vastOptions: {
                adList: adList,
                adCTAText: 'Ver Publicidad',
                vpaidMode: 'ENABLED',
                vastAdvanced: {
                    googleImaSettings: {
                        locale: 'es',
                        disableCustomPlaybackForIOS10Plus: true
                    }
                },
                maxAllowedVastTagRedirects: 5
            }
        });

        // Cargar video principal
        const videoElement = document.getElementById('video-player');
        videoElement.src = videoUrl;

        // Manejo de errores
        videoElement.addEventListener('error', () => {
            document.getElementById('video-container').innerHTML = `
                <div style="color: white; padding: 20px; text-align: center;">
                    <h2>Error de carga</h2>
                    <p>El video no puede ser reproducido</p>
                    ${videoUrl ? `<p>URL intentada: ${videoUrl}</p>` : ''}
                </div>
            `;
        });
    </script>
</body>
</html>
